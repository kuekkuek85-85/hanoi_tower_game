# SRD.md

# 하노이타워 게임 웹사이트 – 소프트웨어 요구사항 명세서 (Replit + Supabase)

## 1. 기술 스택
- **프론트엔드**: HTML/CSS/JS(ES Modules) 또는 Vite + Vanilla/React
- **DND**: Pointer Events 기반(마우스/터치 겸용)
- **오디오**: `<audio>` 또는 Web Audio API
- **DB**: Supabase(PostgreSQL) + RLS
- **배포**: Replit

## 2. 기능 요구사항 상세
- 입력 검증: `^\d{5}\s[가-힣A-Za-z]+$`
- 원판 개수: 3~10
- 타이머 및 이동 카운트 자동화
- 규칙 위반 시 드롭 불가 + 경고음
- 승리 조건: 목표 기둥에 모든 원판이 순서대로 쌓임

## 3. 드래그 앤 드롭
- `pointerdown` → 원판 선택(기둥 top만)
- `pointermove` → 드래그
- `pointerup` → 드롭 → 규칙 검증 후 성공/실패 처리

## 4. 명예의 전당
- 저장 시: 학번, 이름, 원판, 이동수, 시간, 저장시각
- 조회: Top 10, 검색/필터 가능
- 정렬: 원판 ASC → 이동수 ASC → 시간 ASC

## 5. Supabase DB 스키마
```sql
create table if not exists public.hanoi_records (
  id uuid primary key default gen_random_uuid(),
  student_id text not null check (student_id ~ '^[0-9]{5}$'),
  student_name text not null,
  disks int not null check (disks between 3 and 10),
  moves int not null,
  seconds int not null,
  created_at timestamptz not null default now()
);

alter table public.hanoi_records enable row level security;

create policy "Allow read to anon"
on public.hanoi_records
for select
to anon
using (true);

create policy "Allow insert to anon"
on public.hanoi_records
for insert
to anon
with check (true);
```

## 6. 상태 관리
```ts
type TowerState = number[][];
type GameState = {
  studentId: string;
  studentName: string;
  disks: number;
  towers: TowerState;
  moves: number;
  startedAt: number;
  secondsElapsed: number;
  history: {from:number; to:number; disk:number}[];
  completed: boolean;
};
```

## 7. 버전별 구현 체크리스트

### v0.1 – 코어 게임
- [ ] 시작 화면(입력/검증/원판 선택)
- [ ] 보드 렌더링
- [ ] 드래그 앤 드롭
- [ ] 규칙 검증
- [ ] 이동/최소 이동 표시
- [ ] 타이머
- [ ] 효과음
- [ ] 승리 조건 처리

### v0.2 – 리더보드
- [ ] Supabase 연동
- [ ] 저장 버튼
- [ ] DB Insert
- [ ] 리더보드 조회/정렬
- [ ] 검색/필터
- [ ] 반응형 UI

### v0.3 – 확장
- [ ] Undo 1-step
- [ ] 키보드 접근 모드

## 8. 운영/유지보수
- Replit 배포
- 효과음 로컬 자산 관리
- 학번/이름 외 개인정보 수집 금지
- 로그 최소화
